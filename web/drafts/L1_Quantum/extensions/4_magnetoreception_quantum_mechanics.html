<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magnetoreception Quantum Mechanics</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.26.0/plotly.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
            margin: 0;
            padding: 20px;
            color: #2c3e50;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 50%, #2c3e50 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="compass" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" fill="rgba(255,255,255,0.1)"/><path d="M10,5 L10,15 M5,10 L15,10" stroke="rgba(255,255,255,0.05)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23compass)"/></svg>');
            opacity: 0.3;
        }
        
        .header h1 {
            margin: 0;
            font-size: 3em;
            font-weight: 300;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            position: relative;
            z-index: 1;
            color: white;
        }
        
        .header p {
            font-size: 1.3em;
            margin: 10px 0 0 0;
            opacity: 0.9;
            position: relative;
            z-index: 1;
            color: white;
        }
        
        .section {
            padding: 40px;
            border-bottom: 1px solid #ecf0f1;
            background: white;
            color: #2c3e50;
        }
        
        .section:last-child {
            border-bottom: none;
        }
        
        .section-title {
            color: #3498db;
            font-size: 2.2em;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 4px solid #3498db;
            display: flex;
            align-items: center;
            position: relative;
        }
        
        .section-title::before {
            content: "üß≠";
            margin-right: 15px;
            font-size: 1.2em;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
        }
        
        .formula-box {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        .formula-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g transform="rotate(45 50 50)"><circle cx="30" cy="30" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="70" cy="70" r="1" fill="rgba(255,255,255,0.1)"/></g></svg>');
            opacity: 0.3;
        }
        
        .formula-title {
            font-weight: bold;
            font-size: 1.3em;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            color: white;
        }
        
        .math {
            font-family: 'Times New Roman', serif;
            font-size: 1.4em;
            margin: 15px 0;
            background: rgba(255,255,255,0.95);
            color: #2c3e50;
            padding: 15px;
            border-radius: 10px;
            position: relative;
            z-index: 1;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .formula-box p {
            color: white;
            position: relative;
            z-index: 1;
            margin: 15px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .radical-pair-container {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            color: white;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        
        .radical-pair-container h3 {
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            margin-top: 0;
            text-align: center;
        }
        
        .spin-visualization {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .spin-state {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            backdrop-filter: blur(5px);
            min-width: 150px;
        }
        
        .spin-state:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            border-color: rgba(255,255,255,0.5);
        }
        
        .spin-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }
        
        .spin-label {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
            color: white;
        }
        
        .spin-description {
            font-size: 0.9em;
            opacity: 0.8;
            color: white;
        }
        
        .parameter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .param-card {
            background: linear-gradient(135deg, #ecf0f1 0%, #d5dbdb 100%);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            color: #2c3e50;
        }
        
        .param-card:hover {
            transform: translateY(-5px);
        }
        
        .param-title {
            font-weight: bold;
            color: #3498db;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        
        .param-value {
            font-size: 1.4em;
            color: #e74c3c;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .param-card p {
            color: #2c3e50;
        }
        
        .diagram-container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 1px solid #ecf0f1;
        }
        
        .insight-box {
            background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            border-left: 6px solid #3498db;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            color: #2c3e50;
        }
        
        .insight-box h3 {
            color: #2980b9;
            margin-top: 0;
            font-size: 1.4em;
        }
        
        .insight-box ul, .insight-box p {
            color: #2c3e50;
        }
        
        .cryptochrome-structure {
            background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            color: white;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        
        .molecule-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .molecule-component {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .molecule-component:hover {
            transform: scale(1.05);
            border-color: rgba(255,255,255,0.5);
        }
        
        .molecule-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .molecule-name {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
            color: white;
        }
        
        .molecule-role {
            font-size: 0.9em;
            opacity: 0.8;
            color: white;
        }
        
        .compass-simulation {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            color: white;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        
        .compass-dial {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, #fff 30%, #34495e 31%, #34495e 70%, #2c3e50 71%);
            position: relative;
            margin: 20px auto;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        
        .compass-needle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 80px;
            background: linear-gradient(to bottom, #e74c3c 0%, #e74c3c 50%, #34495e 50%, #34495e 100%);
            transform-origin: 50% 90%;
            transform: translate(-50%, -90%) rotate(0deg);
            border-radius: 2px;
            transition: transform 0.5s ease;
        }
        
        .field-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .field-button {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .field-button:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }
        
        .field-button.active {
            background: rgba(255,255,255,0.4);
            border-color: rgba(255,255,255,0.6);
        }
        
        @media (max-width: 768px) {
            .parameter-grid {
                grid-template-columns: 1fr;
            }
            .spin-visualization {
                flex-direction: column;
            }
            .molecule-grid {
                grid-template-columns: 1fr;
            }
            .field-controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Magnetoreception Quantum Mechanics</h1>
            <p>Detailed Quantum Treatment of the Radical Pair Mechanism in Biological Navigation</p>
        </div>

        <div class="section">
            <div class="section-title">Mathematical Framework</div>
            
            <div class="formula-box">
                <div class="formula-title">Radical Pair Hamiltonian</div>
                <div class="math">
                    <strong>H<sub>RP</sub> = œâ<sub>S</sub>S<sub>z</sub> + œâ<sub>T</sub>T<sub>z</sub> + Jùêí¬∑ùêì + Œ©¬∑(g<sub>S</sub>ùêí + g<sub>T</sub>ùêì)</strong>
                </div>
                <p>Where ùêí, ùêì are electron spins, œâ are Zeeman frequencies, J is exchange coupling (~0.1-1 MHz), Œ© is the geomagnetic field (~50 ŒºT), and g are gyromagnetic ratios.</p>
            </div>

            <div class="parameter-grid">
                <div class="formula-box">
                    <div class="formula-title">Singlet-Triplet Interconversion Rate</div>
                    <div class="math">
                        k<sub>ST</sub> = (J¬≤/‚Ñè¬≤) √ó (œÑ<sub>c</sub>/(1 + œâ¬≤œÑ<sub>c</sub>¬≤))
                    </div>
                    <p>With correlation time œÑ<sub>c</sub> ~ 10‚Åª‚Åπ s, yielding navigation-relevant rates k<sub>ST</sub> ~ 10‚Å∂ s‚Åª¬π.</p>
                </div>

                <div class="formula-box">
                    <div class="formula-title">Zeeman Splitting</div>
                    <div class="math">
                        ŒîE<sub>Zeeman</sub> = gŒº<sub>B</sub>B ~ 10‚Åª‚Å∂ eV
                    </div>
                    <p>Energy difference between spin states in the geomagnetic field, enabling directional sensitivity.</p>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Radical Pair Spin States</div>
            
            <div class="radical-pair-container">
                <h3>Electron Spin Configuration in Cryptochrome</h3>
                
                <div class="spin-visualization">
                    <div class="spin-state" onclick="highlightState('singlet')">
                        <div class="spin-icon">‚Üë‚Üì</div>
                        <div class="spin-label">Singlet State</div>
                        <div class="spin-description">Anti-parallel spins<br>Total spin = 0</div>
                    </div>
                    
                    <div class="spin-state" onclick="highlightState('triplet0')">
                        <div class="spin-icon">‚Üë‚Üì</div>
                        <div class="spin-label">Triplet T‚ÇÄ</div>
                        <div class="spin-description">Mixed state<br>Total spin = 1</div>
                    </div>
                    
                    <div class="spin-state" onclick="highlightState('triplet+')">
                        <div class="spin-icon">‚Üë‚Üë</div>
                        <div class="spin-label">Triplet T‚Çä</div>
                        <div class="spin-description">Parallel spins<br>Total spin = 1</div>
                    </div>
                    
                    <div class="spin-state" onclick="highlightState('triplet-')">
                        <div class="spin-icon">‚Üì‚Üì</div>
                        <div class="spin-label">Triplet T‚Çã</div>
                        <div class="spin-description">Parallel spins<br>Total spin = 1</div>
                    </div>
                </div>
                
                <p style="text-align: center; margin-bottom: 0; color: white;">
                    Click on spin states to see their role in magnetoreception. The geomagnetic field modulates 
                    the interconversion between singlet and triplet states, creating orientation-dependent yields.
                </p>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Cryptochrome Molecular Structure</div>
            
            <div class="cryptochrome-structure">
                <h3 style="text-align: center; margin-top: 0;">Key Components of the Magnetoreceptor</h3>
                
                <div class="molecule-grid">
                    <div class="molecule-component" onclick="showMoleculeInfo('fad')">
                        <div class="molecule-icon">üü°</div>
                        <div class="molecule-name">FAD (Flavin)</div>
                        <div class="molecule-role">Photon absorber<br>Initial electron donor</div>
                    </div>
                    
                    <div class="molecule-component" onclick="showMoleculeInfo('trp')">
                        <div class="molecule-icon">üü£</div>
                        <div class="molecule-name">Tryptophan (Trp)</div>
                        <div class="molecule-role">Electron acceptor<br>Radical pair partner</div>
                    </div>
                    
                    <div class="molecule-component" onclick="showMoleculeInfo('protein')">
                        <div class="molecule-icon">üîµ</div>
                        <div class="molecule-name">Protein Matrix</div>
                        <div class="molecule-role">Structural scaffold<br>Hyperfine coupling</div>
                    </div>
                    
                    <div class="molecule-component" onclick="showMoleculeInfo('retina')">
                        <div class="molecule-icon">üëÅÔ∏è</div>
                        <div class="molecule-name">Retinal Cells</div>
                        <div class="molecule-role">Signal transduction<br>Neural processing</div>
                    </div>
                </div>
                
                <p style="text-align: center; margin-bottom: 0; color: white;">
                    The cryptochrome protein contains all necessary components for quantum magnetoreception, 
                    from photon absorption to neural signal generation.
                </p>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Magnetic Field Sensitivity</div>
            
            <div class="parameter-grid">
                <div class="param-card">
                    <div class="param-title">Earth's Magnetic Field</div>
                    <div class="param-value">~50 ŒºT</div>
                    <p>Typical strength of geomagnetic field at Earth's surface, sufficient to influence radical pair dynamics</p>
                </div>
                
                <div class="param-card">
                    <div class="param-title">Exchange Coupling</div>
                    <div class="param-value">J ~ 0.1-1 MHz</div>
                    <p>Strength of electron-electron interaction in the radical pair, determining sensitivity range</p>
                </div>
                
                <div class="param-card">
                    <div class="param-title">Interconversion Rate</div>
                    <div class="param-value">k<sub>ST</sub> ~ 10‚Å∂ s‚Åª¬π</div>
                    <p>Rate of singlet-triplet transitions, fast enough for real-time navigation</p>
                </div>
                
                <div class="param-card">
                    <div class="param-title">Coherence Time</div>
                    <div class="param-value">œÑ ~ 1-100 Œºs</div>
                    <p>Duration of quantum coherence in radical pairs, determining sensitivity limits</p>
                </div>
            </div>
            
            <div class="diagram-container">
                <div id="fieldSensitivity" style="width:100%;height:400px;"></div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Quantum Compass Simulation</div>
            
            <div class="compass-simulation">
                <h3 style="text-align: center; margin-top: 0;">Interactive Magnetoreception Model</h3>
                
                <div class="compass-dial">
                    <div class="compass-needle" id="compassNeedle"></div>
                </div>
                
                <div class="field-controls">
                    <button class="field-button active" onclick="setFieldDirection(0)">North</button>
                    <button class="field-button" onclick="setFieldDirection(90)">East</button>
                    <button class="field-button" onclick="setFieldDirection(180)">South</button>
                    <button class="field-button" onclick="setFieldDirection(270)">West</button>
                    <button class="field-button" onclick="setFieldDirection(45)">NE</button>
                    <button class="field-button" onclick="setFieldDirection(315)">NW</button>
                </div>
                
                <p style="text-align: center; margin-bottom: 0; color: white;">
                    Simulate how the radical pair mechanism responds to different magnetic field orientations.
                    The compass needle represents the quantum yield orientation dependence.
                </p>
            </div>
            
            <div class="diagram-container">
                <div id="quantumYield" style="width:100%;height:400px;"></div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Spin Dynamics Evolution</div>
            
            <div class="diagram-container">
                <div id="spinEvolution" style="width:100%;height:400px;"></div>
            </div>
            
            <div class="formula-box">
                <div class="formula-title">Time Evolution of Spin States</div>
                <div class="math">
                    |œà(t)‚ü© = c<sub>S</sub>(t)|S‚ü© + c<sub>T‚ÇÄ</sub>(t)|T‚ÇÄ‚ü© + c<sub>T‚Çä</sub>(t)|T‚Çä‚ü© + c<sub>T‚Çã</sub>(t)|T‚Çã‚ü©
                </div>
                <p>The coefficients c<sub>i</sub>(t) evolve according to the Schr√∂dinger equation with the radical pair Hamiltonian, showing oscillatory behavior modulated by the magnetic field.</p>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Hyperfine Coupling Effects</div>
            
            <div class="diagram-container">
                <div id="hyperfineCoupling" style="width:100%;height:400px;"></div>
            </div>
            
            <div class="insight-box">
                <h3>üß≠ Quantum Mechanisms in Navigation</h3>
                <ul>
                    <li><strong>Photoinitiation:</strong> Blue light (420-480 nm) excites FAD, creating the initial radical pair in a pure singlet state</li>
                    <li><strong>Spin Evolution:</strong> Magnetic fields and hyperfine interactions drive coherent oscillations between singlet and triplet states</li>
                    <li><strong>Chemical Sensitivity:</strong> Different spin states follow distinct reaction pathways, creating orientation-dependent product yields</li>
                    <li><strong>Signal Transduction:</strong> Chemical products modulate retinal cell activity, encoding magnetic information as neural signals</li>
                    <li><strong>Noise Resilience:</strong> Quantum error correction and protein shielding maintain coherence despite thermal fluctuations</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Orientation-Dependent Quantum Yield</div>
            
            <div class="diagram-container">
                <div id="orientationYield" style="width:100%;height:450px;"></div>
            </div>
            
            <div class="insight-box">
                <h3>üî¨ Experimental Signatures</h3>
                <p><strong>Isotope Effects:</strong> Replacing ¬πH with ¬≤H or ¬π‚Å¥N with ¬π‚ÅµN alters hyperfine couplings, shifting sensitivity patterns</p>
                <p><strong>Radio Frequency Disruption:</strong> Weak RF fields (0.1-10 MHz) can disrupt magnetoreception by inducing additional spin transitions</p>
                <p><strong>Light Dependence:</strong> Magnetosensitivity requires blue light activation, linking to cryptochrome photocycles</p>
                <p><strong>Angular Sensitivity:</strong> Navigation accuracy shows predicted angular dependence based on molecular orientation relative to magnetic field</p>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Biological Implementation</div>
            
            <div class="diagram-container">
                <div id="biologicalPathway" style="width:100%;height:500px;"></div>
            </div>
            
            <div class="insight-box">
                <h3>üß¨ From Molecules to Navigation</h3>
                <p><strong>Retinal Distribution:</strong> Cryptochromes are concentrated in specific retinal cell types, creating a directional map</p>
                <p><strong>Neural Processing:</strong> Magnetic signals integrate with visual information in specialized brain regions</p>
                <p><strong>Behavioral Output:</strong> Processed magnetic information guides migration routes and territorial navigation</p>
                <p><strong>Evolutionary Advantage:</strong> Quantum magnetoreception provides precision navigation across thousands of kilometers</p>
            </div>
        </div>
    </div>

    <script>
        let currentOrientation = 0;
        let selectedSpinState = null;
        
        function highlightState(state) {
            selectedSpinState = state;
            const states = document.querySelectorAll('.spin-state');
            states.forEach(s => s.style.opacity = '0.7');
            event.target.closest('.spin-state').style.opacity = '1';
            
            console.log(`Selected spin state: ${state}`);
            updateQuantumYieldPlot();
        }
        
        function showMoleculeInfo(molecule) {
            const info = {
                'fad': 'FAD absorbs blue photons and becomes excited, initiating electron transfer to create the radical pair.',
                'trp': 'Tryptophan receives the electron from excited FAD, forming the second half of the radical pair.',
                'protein': 'The protein matrix provides hyperfine couplings and protects quantum coherence from decoherence.',
                'retina': 'Retinal cells transduce the chemical signals into neural activity for brain processing.'
            };
            
            alert(info[molecule]);
        }
        
        function setFieldDirection(angle) {
            currentOrientation = angle;
            const needle = document.getElementById('compassNeedle');
            needle.style.transform = `translate(-50%, -90%) rotate(${angle}deg)`;
            
            // Update button states
            const buttons = document.querySelectorAll('.field-button');
            buttons.forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            
            updateQuantumYieldPlot();
        }
        
        function plotFieldSensitivity() {
            const fieldStrengths = [];
            const singletYields = [];
            const tripletYields = [];
            
            for (let B = 0; B <= 200; B += 5) {
                fieldStrengths.push(B);
                
                // Simplified model: yield depends on Zeeman splitting
                const zeeman = 1.4e-6 * B; // ŒºB * g * B in eV
                const J = 6.6e-7; // Exchange coupling in eV (1 MHz)
                
                // Singlet yield decreases with field strength
                const singletYield = 0.5 * (1 + Math.exp(-zeeman/J) * Math.cos(zeeman * 1e-9 / 6.58e-16));
                singletYields.push(singletYield);
                tripletYields.push(1 - singletYield);
            }
            
            const trace1 = {
                x: fieldStrengths,
                y: singletYields,
                type: 'scatter',
                mode: 'lines',
                name: 'Singlet Yield',
                line: { color: '#3498db', width: 3 }
            };
            
            const trace2 = {
                x: fieldStrengths,
                y: tripletYields,
                type: 'scatter',
                mode: 'lines',
                name: 'Triplet Yield',
                line: { color: '#e74c3c', width: 3 }
            };
            
            // Mark Earth's field
            const earthField = {
                x: [50, 50],
                y: [0, 1],
                type: 'scatter',
                mode: 'lines',
                name: "Earth's Field (~50 ŒºT)",
                line: { color: '#f39c12', width: 3, dash: 'dash' }
            };
            
            const layout = {
                title: {
                    text: 'Magnetic Field Sensitivity of Radical Pair States',
                    font: { size: 18, color: '#2c3e50' }
                },
                xaxis: { 
                    title: 'Magnetic Field Strength (ŒºT)',
                    gridcolor: '#ecf0f1'
                },
                yaxis: { 
                    title: 'Quantum Yield',
                    range: [0, 1],
                    gridcolor: '#ecf0f1'
                },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: 'white'
            };
            
            Plotly.newPlot('fieldSensitivity', [trace1, trace2, earthField], layout);
        }
        
        function updateQuantumYieldPlot() {
            const angles = [];
            const yields = [];
            
            for (let theta = 0; theta <= 360; theta += 5) {
                angles.push(theta);
                // Orientation dependence from anisotropic hyperfine coupling
                const yield = 0.5 + 0.3 * Math.cos(2 * theta * Math.PI / 180) + 0.1 * Math.cos(4 * theta * Math.PI / 180);
                yields.push(yield);
            }
            
            // Mark current orientation
            const currentYield = 0.5 + 0.3 * Math.cos(2 * currentOrientation * Math.PI / 180) + 0.1 * Math.cos(4 * currentOrientation * Math.PI / 180);
            
            const trace = {
                x: angles,
                y: yields,
                type: 'scatter',
                mode: 'lines',
                name: 'Quantum Yield',
                line: { color: '#9b59b6', width: 3 }
            };
            
            const currentPoint = {
                x: [currentOrientation],
                y: [currentYield],
                type: 'scatter',
                mode: 'markers',
                name: 'Current Orientation',
                marker: { 
                    color: '#e74c3c', 
                    size: 12,
                    symbol: 'diamond'
                }
            };
            
            const layout = {
                title: {
                    text: 'Orientation-Dependent Quantum Yield',
                    font: { size: 18, color: '#2c3e50' }
                },
                xaxis: { 
                    title: 'Field Orientation (degrees)',
                    range: [0, 360],
                    gridcolor: '#ecf0f1'
                },
                yaxis: { 
                    title: 'Singlet Product Yield',
                    range: [0, 1],
                    gridcolor: '#ecf0f1'
                },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: 'white'
            };
            
            Plotly.newPlot('quantumYield', [trace, currentPoint], layout);
        }
        
        function plotSpinEvolution() {
            const time = [];
            const singletProb = [];
            const tripletProb = [];
            
            const J = 1e6; // Exchange coupling in Hz
            const omega = 1.4e6; // Zeeman frequency in Hz (50 ŒºT field)
            
            for (let t = 0; t <= 10; t += 0.1) {
                time.push(t);
                
                // Simplified time evolution starting from pure singlet
                const prob_s = Math.cos(Math.PI * J * t * 1e-6) ** 2 * Math.exp(-t / 50); // with decoherence
                const prob_t = 1 - prob_s;
                
                singletProb.push(prob_s);
                tripletProb.push(prob_t);
            }
            
            const trace1 = {
                x: time,
                y: singletProb,
                type: 'scatter',
                mode: 'lines',
                name: 'Singlet Probability',
                line: { color: '#3498db', width: 3 }
            };
            
            const trace2 = {
                x: time,
                y: tripletProb,
                type: 'scatter',
                mode: 'lines',
                name: 'Triplet Probability',
                line: { color: '#e74c3c', width: 3 }
            };
            
            const layout = {
                title: {
                    text: 'Quantum Spin State Evolution',
                    font: { size: 18, color: '#2c3e50' }
                },
                xaxis: { 
                    title: 'Time (Œºs)',
                    gridcolor: '#ecf0f1'
                },
                yaxis: { 
                    title: 'State Probability',
                    range: [0, 1],
                    gridcolor: '#ecf0f1'
                },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: 'white'
            };
            
            Plotly.newPlot('spinEvolution', [trace1, trace2], layout);
        }
        
        function plotHyperfineCoupling() {
            const nuclei = ['¬πH', '¬π‚Å¥N', '¬π¬≥C', '¬≥¬πP'];
            const couplings = [50, 5, 20, 100]; // MHz
            const colors = ['#3498db', '#e74c3c', '#f39c12', '#9b59b6'];
            
            const traces = nuclei.map((nucleus, i) => ({
                x: [nucleus],
                y: [couplings[i]],
                type: 'bar',
                name: nucleus,
                marker: { color: colors[i] }
            }));
            
            // Combined trace for proper display
            const trace = {
                x: nuclei,
                y: couplings,
                type: 'bar',
                marker: { 
                    color: colors,
                    opacity: 0.8
                },
                name: 'Hyperfine Coupling'
            };
            
            const layout = {
                title: {
                    text: 'Hyperfine Coupling Strengths in Cryptochrome',
                    font: { size: 18, color: '#2c3e50' }
                },
                xaxis: { 
                    title: 'Nuclear Isotopes',
                    gridcolor: '#ecf0f1'
                },
                yaxis: { 
                    title: 'Coupling Strength (MHz)',
                    gridcolor: '#ecf0f1'
                },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: 'white',
                showlegend: false
            };
            
            Plotly.newPlot('hyperfineCoupling', [trace], layout);
        }
        
        function plotOrientationYield() {
            const theta = [];
            const phi = [];
            const yields = [];
            
            // Create 3D surface for orientation dependence
            for (let t = 0; t <= 180; t += 10) {
                for (let p = 0; p <= 360; p += 10) {
                    theta.push(t);
                    phi.push(p);
                    
                    // 3D orientation dependence with anisotropic hyperfine tensor
                    const yield = 0.5 + 0.2 * Math.cos(2 * t * Math.PI / 180) * Math.cos(p * Math.PI / 180) 
                                    + 0.1 * Math.sin(t * Math.PI / 180) * Math.sin(2 * p * Math.PI / 180);
                    yields.push(yield);
                }
            }
            
            // Convert to grid format for surface plot
            const z_data = [];
            const x_data = [];
            const y_data = [];
            
            for (let i = 0; i <= 18; i++) {
                z_data[i] = [];
                x_data[i] = [];
                y_data[i] = [];
                for (let j = 0; j <= 36; j++) {
                    const idx = i * 37 + j;
                    z_data[i][j] = yields[idx];
                    x_data[i][j] = phi[idx];
                    y_data[i][j] = theta[idx];
                }
            }
            
            const trace = {
                x: x_data,
                y: y_data,
                z: z_data,
                type: 'surface',
                colorscale: 'Viridis',
                colorbar: { title: 'Quantum Yield' }
            };
            
            const layout = {
                title: {
                    text: '3D Orientation Dependence of Magnetoreception',
                    font: { size: 18, color: '#2c3e50' }
                },
                scene: {
                    xaxis: { title: 'Azimuth œÜ (degrees)' },
                    yaxis: { title: 'Polar Œ∏ (degrees)' },
                    zaxis: { title: 'Quantum Yield' },
                    camera: {
                        eye: { x: 1.5, y: 1.5, z: 1.5 }
                    }
                },
                paper_bgcolor: 'white'
            };
            
            Plotly.newPlot('orientationYield', [trace], layout);
        }
        
        function plotBiologicalPathway() {
            // Create a flowchart of the biological pathway
            const steps = [
                'Blue Light Absorption',
                'FAD* Formation',
                'Electron Transfer',
                'Radical Pair Creation',
                'Spin Evolution',
                'Chemical Products',
                'Signal Transduction',
                'Neural Activity',
                'Navigation Behavior'
            ];
            
            const x_positions = [0, 0, 0, 1, 2, 3, 4, 4, 4];
            const y_positions = [8, 7, 6, 6, 6, 6, 6, 5, 4];
            
            // Node trace
            const nodeTrace = {
                x: x_positions,
                y: y_positions,
                mode: 'markers+text',
                text: steps,
                textposition: 'middle right',
                marker: {
                    size: 20,
                    color: ['#f39c12', '#e67e22', '#e74c3c', '#c0392b', '#9b59b6', '#8e44ad', '#3498db', '#2980b9', '#27ae60'],
                    line: {
                        width: 2,
                        color: 'white'
                    }
                },
                textfont: {
                    size: 12,
                    color: '#2c3e50'
                },
                hoverinfo: 'text',
                type: 'scatter'
            };
            
            // Edge trace
            const edgeX = [];
            const edgeY = [];
            
            for (let i = 0; i < steps.length - 1; i++) {
                edgeX.push(x_positions[i], x_positions[i + 1], null);
                edgeY.push(y_positions[i], y_positions[i + 1], null);
            }
            
            const edgeTrace = {
                x: edgeX,
                y: edgeY,
                mode: 'lines',
                line: {
                    width: 3,
                    color: 'rgba(52, 152, 219, 0.5)'
                },
                hoverinfo: 'none',
                type: 'scatter'
            };
            
            const layout = {
                title: {
                    text: 'Magnetoreception: From Photons to Navigation',
                    font: { size: 18, color: '#2c3e50' }
                },
                showlegend: false,
                xaxis: {
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    range: [-1, 6]
                },
                yaxis: {
                    showgrid: false,
                    zeroline: false,
                    showticklabels: false,
                    range: [3, 9]
                },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: 'white',
                annotations: [
                    {
                        x: 2,
                        y: 3.5,
                        text: 'Quantum Processes ‚Üí Classical Biology ‚Üí Behavior',
                        showarrow: false,
                        font: { size: 14, color: '#7f8c8d' }
                    }
                ]
            };
            
            Plotly.newPlot('biologicalPathway', [edgeTrace, nodeTrace], layout);
        }
        
        // Initialize all plots
        window.onload = function() {
            try {
                plotFieldSensitivity();
                updateQuantumYieldPlot();
                plotSpinEvolution();
                plotHyperfineCoupling();
                plotOrientationYield();
                plotBiologicalPathway();
            } catch (error) {
                console.error('Error initializing plots:', error);
            }
        };
    </script>
</body>
</html>